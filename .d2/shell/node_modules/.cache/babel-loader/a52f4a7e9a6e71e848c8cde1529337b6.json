{"ast":null,"code":"import * as multipartFormDataMatchers from './multipartFormDataMatchers';\nimport * as textPlainMatchers from './textPlainMatchers';\n\nconst resourceExpectsTextPlain = (type, query) => Object.values(textPlainMatchers).some(textPlainMatcher => textPlainMatcher(type, query));\n\nconst resourceExpectsMultipartFormData = (type, query) => Object.values(multipartFormDataMatchers).some(multipartFormDataMatcher => multipartFormDataMatcher(type, query));\n\nexport const FORM_DATA_ERROR_MSG = 'Could not convert data to FormData: object does not have own enumerable string-keyed properties';\n\nconst convertToFormData = data => {\n  const dataEntries = Object.entries(data);\n\n  if (dataEntries.length === 0) {\n    throw new Error(FORM_DATA_ERROR_MSG);\n  }\n\n  return dataEntries.reduce((formData, [key, value]) => {\n    formData.append(key, value);\n    return formData;\n  }, new FormData());\n};\n\nexport const requestContentType = (type, query) => {\n  if (!query.data) {\n    return null;\n  }\n\n  if (resourceExpectsTextPlain(type, query)) {\n    return 'text/plain';\n  }\n\n  if (resourceExpectsMultipartFormData(type, query)) {\n    return 'multipart/form-data';\n  }\n\n  return 'application/json';\n};\nexport const requestHeadersForContentType = contentType => {\n  /*\n   * Explicitely setting Content-Type to 'multipart/form-data' produces\n   * a \"multipart boundary not found\" error. By not setting a Content-Type\n   * the browser will correctly set it for us and also apply multipart\n   * boundaries if the request body is an instance of FormData\n   * See https://stackoverflow.com/a/39281156/1143502\n   */\n  if (!contentType || contentType === 'multipart/form-data') {\n    return undefined;\n  }\n\n  return {\n    'Content-Type': contentType\n  };\n};\nexport const requestBodyForContentType = (contentType, {\n  data\n}) => {\n  if (typeof data === 'undefined') {\n    return undefined;\n  }\n\n  if (contentType === 'application/json') {\n    return JSON.stringify(data);\n  }\n\n  if (contentType === 'multipart/form-data') {\n    return convertToFormData(data);\n  } // 'text/plain'\n\n\n  return data;\n};","map":{"version":3,"sources":["/Users/rajabu/.config/yarn/global/node_modules/@dhis2/app-service-data/build/es/links/RestAPILink/queryToRequestOptions/requestContentType.js"],"names":["multipartFormDataMatchers","textPlainMatchers","resourceExpectsTextPlain","type","query","Object","values","some","textPlainMatcher","resourceExpectsMultipartFormData","multipartFormDataMatcher","FORM_DATA_ERROR_MSG","convertToFormData","data","dataEntries","entries","length","Error","reduce","formData","key","value","append","FormData","requestContentType","requestHeadersForContentType","contentType","undefined","requestBodyForContentType","JSON","stringify"],"mappings":"AAAA,OAAO,KAAKA,yBAAZ,MAA2C,6BAA3C;AACA,OAAO,KAAKC,iBAAZ,MAAmC,qBAAnC;;AAEA,MAAMC,wBAAwB,GAAG,CAACC,IAAD,EAAOC,KAAP,KAAiBC,MAAM,CAACC,MAAP,CAAcL,iBAAd,EAAiCM,IAAjC,CAAsCC,gBAAgB,IAAIA,gBAAgB,CAACL,IAAD,EAAOC,KAAP,CAA1E,CAAlD;;AAEA,MAAMK,gCAAgC,GAAG,CAACN,IAAD,EAAOC,KAAP,KAAiBC,MAAM,CAACC,MAAP,CAAcN,yBAAd,EAAyCO,IAAzC,CAA8CG,wBAAwB,IAAIA,wBAAwB,CAACP,IAAD,EAAOC,KAAP,CAAlG,CAA1D;;AAEA,OAAO,MAAMO,mBAAmB,GAAG,iGAA5B;;AAEP,MAAMC,iBAAiB,GAAGC,IAAI,IAAI;AAChC,QAAMC,WAAW,GAAGT,MAAM,CAACU,OAAP,CAAeF,IAAf,CAApB;;AAEA,MAAIC,WAAW,CAACE,MAAZ,KAAuB,CAA3B,EAA8B;AAC5B,UAAM,IAAIC,KAAJ,CAAUN,mBAAV,CAAN;AACD;;AAED,SAAOG,WAAW,CAACI,MAAZ,CAAmB,CAACC,QAAD,EAAW,CAACC,GAAD,EAAMC,KAAN,CAAX,KAA4B;AACpDF,IAAAA,QAAQ,CAACG,MAAT,CAAgBF,GAAhB,EAAqBC,KAArB;AACA,WAAOF,QAAP;AACD,GAHM,EAGJ,IAAII,QAAJ,EAHI,CAAP;AAID,CAXD;;AAaA,OAAO,MAAMC,kBAAkB,GAAG,CAACrB,IAAD,EAAOC,KAAP,KAAiB;AACjD,MAAI,CAACA,KAAK,CAACS,IAAX,EAAiB;AACf,WAAO,IAAP;AACD;;AAED,MAAIX,wBAAwB,CAACC,IAAD,EAAOC,KAAP,CAA5B,EAA2C;AACzC,WAAO,YAAP;AACD;;AAED,MAAIK,gCAAgC,CAACN,IAAD,EAAOC,KAAP,CAApC,EAAmD;AACjD,WAAO,qBAAP;AACD;;AAED,SAAO,kBAAP;AACD,CAdM;AAeP,OAAO,MAAMqB,4BAA4B,GAAGC,WAAW,IAAI;AACzD;AACF;AACA;AACA;AACA;AACA;AACA;AACE,MAAI,CAACA,WAAD,IAAgBA,WAAW,KAAK,qBAApC,EAA2D;AACzD,WAAOC,SAAP;AACD;;AAED,SAAO;AACL,oBAAgBD;AADX,GAAP;AAGD,CAfM;AAgBP,OAAO,MAAME,yBAAyB,GAAG,CAACF,WAAD,EAAc;AACrDb,EAAAA;AADqD,CAAd,KAEnC;AACJ,MAAI,OAAOA,IAAP,KAAgB,WAApB,EAAiC;AAC/B,WAAOc,SAAP;AACD;;AAED,MAAID,WAAW,KAAK,kBAApB,EAAwC;AACtC,WAAOG,IAAI,CAACC,SAAL,CAAejB,IAAf,CAAP;AACD;;AAED,MAAIa,WAAW,KAAK,qBAApB,EAA2C;AACzC,WAAOd,iBAAiB,CAACC,IAAD,CAAxB;AACD,GAXG,CAWF;;;AAGF,SAAOA,IAAP;AACD,CAjBM","sourcesContent":["import * as multipartFormDataMatchers from './multipartFormDataMatchers';\nimport * as textPlainMatchers from './textPlainMatchers';\n\nconst resourceExpectsTextPlain = (type, query) => Object.values(textPlainMatchers).some(textPlainMatcher => textPlainMatcher(type, query));\n\nconst resourceExpectsMultipartFormData = (type, query) => Object.values(multipartFormDataMatchers).some(multipartFormDataMatcher => multipartFormDataMatcher(type, query));\n\nexport const FORM_DATA_ERROR_MSG = 'Could not convert data to FormData: object does not have own enumerable string-keyed properties';\n\nconst convertToFormData = data => {\n  const dataEntries = Object.entries(data);\n\n  if (dataEntries.length === 0) {\n    throw new Error(FORM_DATA_ERROR_MSG);\n  }\n\n  return dataEntries.reduce((formData, [key, value]) => {\n    formData.append(key, value);\n    return formData;\n  }, new FormData());\n};\n\nexport const requestContentType = (type, query) => {\n  if (!query.data) {\n    return null;\n  }\n\n  if (resourceExpectsTextPlain(type, query)) {\n    return 'text/plain';\n  }\n\n  if (resourceExpectsMultipartFormData(type, query)) {\n    return 'multipart/form-data';\n  }\n\n  return 'application/json';\n};\nexport const requestHeadersForContentType = contentType => {\n  /*\n   * Explicitely setting Content-Type to 'multipart/form-data' produces\n   * a \"multipart boundary not found\" error. By not setting a Content-Type\n   * the browser will correctly set it for us and also apply multipart\n   * boundaries if the request body is an instance of FormData\n   * See https://stackoverflow.com/a/39281156/1143502\n   */\n  if (!contentType || contentType === 'multipart/form-data') {\n    return undefined;\n  }\n\n  return {\n    'Content-Type': contentType\n  };\n};\nexport const requestBodyForContentType = (contentType, {\n  data\n}) => {\n  if (typeof data === 'undefined') {\n    return undefined;\n  }\n\n  if (contentType === 'application/json') {\n    return JSON.stringify(data);\n  }\n\n  if (contentType === 'multipart/form-data') {\n    return convertToFormData(data);\n  } // 'text/plain'\n\n\n  return data;\n};"]},"metadata":{},"sourceType":"module"}